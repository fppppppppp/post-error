{"version":3,"file":"bundle.min.js","sources":["../src/config/config.ts","../src/userinfo/index.ts","../src/utils/create-uid.ts","../src/utils/os-browser.js","../src/utils/obersve.ts","../src/service/xhm.ts","../src/config/global-config.ts","../src/bindEvent/bind-close.ts","../src/service/cacheInfo.ts","../src/service/handleErrorPost.ts","../src/utils/error-stack.ts","../src/error-types/index.ts","../src/bindEvent/bind-error.ts","../src/bindEvent/index.ts","../src/bindEvent/bind-xhm.ts","../src/createPlugin/index.ts","../src/index.ts","../src/createPlugin/plugin-react.ts"],"sourcesContent":["export const servicePath = \"http://127.0.0.1:7002/\";\n\n\n","import { uuid } from \"../utils/create-uid\";\nexport interface UserInfo {\n  uid?: string;\n  projectInfo?: string;\n  userid?: string;\n  clientType?: \"1\" | \"2\" | \"3\";\n}\n\nlet userInfo: UserInfo = {\n  clientType: \"1\",\n};\n\n/**\n * 初始化用户个人信息\n */\nexport function initUserInfo(): void {\n  const uid = uuid();\n  userInfo.uid = uid;\n}\n\n/**\n * 获取用户个人信息\n */\nexport function getUserInfo(): UserInfo {\n  if (!userInfo.uid) {\n    initUserInfo();\n  }\n  return userInfo; \n}\n/**\n *\n * 设置用户个人信息\n */\n\nexport function setSystemUser(id: string): void {\n  userInfo.userid = id;\n}\n\nexport function setUser(id: string): void {\n  userInfo.userid = id;\n}\n\nexport function setClientType(id: \"1\" | \"2\" | \"3\"): void {\n  userInfo.clientType = id;\n}\nexport function setProject(id: string): void {\n  userInfo.projectInfo = id;\n}\n\n","export function uuid() {\n    var s = [];\n    var hexDigits = \"0123456789abcdef\";\n    for (var i = 0; i < 36; i++) {\n        s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\n    }\n    s[14] = \"4\";  // bits 12-15 of the time_hi_and_version field to 0010\n    s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);  // bits 6-7 of the clock_seq_hi_and_reserved to 01\n    s[8] = s[13] = s[18] = s[23] = \"-\";\n \n    var uuid = s.join(\"\");\n    return uuid + \"-\" + +new Date();\n}\n","\"use strict\"\nconst _getBrowserinfo = ()=>{\n\tvar document = window.document,\n\t\tnavigator = window.navigator,\n\t\tagent = navigator.userAgent.toLowerCase(),\n\t\t//IE8+支持.返回浏览器渲染当前文档所用的模式\n\t\t//IE6,IE7:undefined.IE8:8(兼容模式返回7).IE9:9(兼容模式返回7||8)\n\t\t//IE10:10(兼容模式7||8||9)\n\t\tIEMode = document.documentMode,\n\t\t//chorme\n\t\tchrome = window.chrome || false,\n\t\tSystem = {\n\t\t\t//user-agent\n\t\t\tagent : agent,\n\t\t\t//是否为IE\n\t\t\tisIE : /msie/.test(agent),\n\t\t\t//Gecko内核\n\t\t\tisGecko: agent.indexOf(\"gecko\")>0 && agent.indexOf(\"like gecko\")<0,\n\t\t\t//webkit内核\n\t\t\tisWebkit: agent.indexOf(\"webkit\")>0,\n\t\t\t//是否为标准模式\n\t\t\tisStrict: document.compatMode === \"CSS1Compat\",\n\t\t\t//是否支持subtitle\n\t\t\tsupportSubTitle:function(){\n\t\t\t\treturn \"track\" in document.createElement(\"track\");\n\t\t\t},\n\t\t\t//是否支持scoped\n\t\t\tsupportScope:function(){\n\t\t\t\treturn \"scoped\" in document.createElement(\"style\");\n\t\t\t},\n\t\t\t//获取IE的版本号\n\t\t\tieVersion:function(){\n\t\t\t\ttry {\n\t\t\t\t   return agent.match(/msie ([\\d.]+)/)[1] || 0;\n\t\t\t\t} catch(e) {\n\t\t\t\t   console.log(\"error\");\n\t\t\t\t   return IEMode;\n\t\t\t\t}\n\t\t\t},\n\t\t\t//Opera版本号\n\t\t\toperaVersion:function(){\n\t\t\t\ttry {\n\t\t\t\t\tif(window.opera) {\n\t\t\t\t\t\treturn agent.match(/opera.([\\d.]+)/)[1];\n\t\t\t\t\t} else if(agent.indexOf(\"opr\") > 0) {\n\t\t\t\t\t\treturn agent.match(/opr\\/([\\d.]+)/)[1];\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t\tconsole.log(\"error\");\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t},\n\t\t\t//描述:version过滤.如31.0.252.152 只保留31.0\n\t\t\tversionFilter:function(...arg){\n\t\t\t\tif(arg.length === 1 && typeof arg[0] === \"string\") {\n\t\t\t\t\tvar version = arg[0],\n\t\t\t\t\t\tstart = version.indexOf(\".\");\n\t\t\t\t\tif(start>0){\n\t\t\t\t\t\tvar end = version.indexOf(\".\",start+1);\n\t\t\t\t\t\tif(end !== -1) {\n\t\t\t\t\t\t\treturn version.substr(0,end);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn version;\n\t\t\t\t} else if(arg.length === 1) {\n\t\t\t\t\treturn arg[0];\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t};\n\n\ttry {\n\t\t//浏览器类型(IE、Opera、Chrome、Safari、Firefox)\n\t\tSystem.type = System.isIE?\"IE\":\n\t\t\twindow.opera || (agent.indexOf(\"opr\") > 0)?\"Opera\":\n\t\t\t(agent.indexOf(\"chrome\")>0)?\"Chrome\":\n\t\t\t//safari也提供了专门的判定方式\n\t\t\twindow.openDatabase?\"Safari\":\n\t\t\t(agent.indexOf(\"firefox\")>0)?\"Firefox\":\n\t\t\t'unknow';\n\n\t\t//版本号\n\t\tSystem.version = (System.type === \"IE\")?System.ieVersion():\n\t\t\t(System.type === \"Firefox\")?agent.match(/firefox\\/([\\d.]+)/)[1]:\n\t\t\t(System.type === \"Chrome\")?agent.match(/chrome\\/([\\d.]+)/)[1]:\n\t\t\t(System.type === \"Opera\")?System.operaVersion():\n\t\t\t(System.type === \"Safari\")?agent.match(/version\\/([\\d.]+)/)[1]:\n\t\t\t\"0\";\n\n\t\t//浏览器外壳\n\t\tSystem.shell=function(){\n\t\t\t//遨游浏览器\n\t\t\tif(agent.indexOf(\"maxthon\") > 0) {\n\t\t\t\tSystem.version = agent.match(/maxthon\\/([\\d.]+)/)[1] || System.version ;\n\t\t\t\treturn \"傲游浏览器\";\n\t\t\t}\n\t\t\t//QQ浏览器\n\t\t\tif(agent.indexOf(\"qqbrowser\") > 0) {\n\t\t\t\tSystem.version = agent.match(/qqbrowser\\/([\\d.]+)/)[1] || System.version ;\n\t\t\t\treturn \"QQ浏览器\";\n\t\t\t}\n\n\t\t\t//搜狗浏览器\n\t\t\tif( agent.indexOf(\"se 2.x\")>0) {\n\t\t\t\treturn '搜狗浏览器';\n\t\t\t}\n\n\t\t\t//Chrome:也可以使用window.chrome && window.chrome.webstore判断\n\t\t\tif(chrome && System.type !== \"Opera\") {\n\t\t\t\tvar external = window.external,\n\t\t\t\t\tclientInfo = window.clientInformation,\n\t\t\t\t\t//客户端语言:zh-cn,zh.360下面会返回undefined\n\t\t\t\t\tclientLanguage = clientInfo.languages;\n\n\t\t\t\t//猎豹浏览器:或者agent.indexOf(\"lbbrowser\")>0\n\t\t\t\tif( external && 'LiebaoGetVersion' in external) {\n\t\t\t\t\t return '猎豹浏览器';\n\t\t\t\t}\n\t\t\t\t//百度浏览器\n\t\t\t\tif (agent.indexOf(\"bidubrowser\")>0) {\n\t\t\t\t\tSystem.version = agent.match(/bidubrowser\\/([\\d.]+)/)[1] ||\n\t\t\t\t\t\tagent.match(/chrome\\/([\\d.]+)/)[1];\n\t\t\t\t\treturn \"百度浏览器\";\n\t\t\t\t}\n\t\t\t\t//360极速浏览器和360安全浏览器\n\t\t\t\tif( System.supportSubTitle() && typeof clientLanguage === \"undefined\") {\n\t\t\t\t\t//object.key()返回一个数组.包含可枚举属性和方法名称\n\t\t\t\t\tvar storeKeyLen = Object.keys(chrome.webstore).length,\n\t\t\t\t\t\tv8Locale = \"v8Locale\" in window;\n\t\t\t\t\treturn storeKeyLen > 1? '360极速浏览器':'360安全浏览器';\n\t\t\t\t}\n\t\t\t\treturn \"Chrome\";\n\t\t\t}\n\t\t\treturn System.type;\n\t\t};\n\n\t\t//浏览器名称(如果是壳浏览器,则返回壳名称)\n\t\tSystem.name = System.shell();\n\t\t//对版本号进行过滤过处理\n\t\tSystem.version = System.versionFilter(System.version);\n\n\t} catch(e) {\n\t\tconsole.log(e);\n\t}\n\treturn {\n\t\tclient:System\n\t};\n\n};\nexport const getBrowserinfo = ()=>{\n    const {\n        agent,\n        version,\n        name,\n        isIE,\n        isGecko,\n        isWebkit,\n        isStrict\n    } = _getBrowserinfo().client;\n    return {\n        agent,\n        version,\n        name,\n        isIE,\n        isGecko,\n        isWebkit,\n        isStrict\n    }\n}\n\n\nexport function getOS() {\n    let sUserAgent = navigator.userAgent;\n    let isWin = (navigator.platform == \"Win32\") || (navigator.platform == \"Windows\");\n    let isMac = (navigator.platform == \"Mac68K\") || (navigator.platform == \"MacPPC\") || (navigator.platform == \"Macintosh\") || (navigator.platform == \"MacIntel\");\n    if (isMac) return \"Mac\";\n    let isUnix = (navigator.platform == \"X11\") && !isWin && !isMac;\n    if (isUnix) return \"Unix\";\n    let isLinux = (String(navigator.platform).indexOf(\"Linux\") > -1);\n    if (isLinux) return \"Linux\";\n    if (isWin) {\n        let isWin2K = sUserAgent.indexOf(\"Windows NT 5.0\") > -1 || sUserAgent.indexOf(\"Windows 2000\") > -1;\n        if (isWin2K) return \"Win2000\";\n        let isWinXP = sUserAgent.indexOf(\"Windows NT 5.1\") > -1 || sUserAgent.indexOf(\"Windows XP\") > -1;\n        if (isWinXP) return \"WinXP\";\n        let isWin2003 = sUserAgent.indexOf(\"Windows NT 5.2\") > -1 || sUserAgent.indexOf(\"Windows 2003\") > -1;\n        if (isWin2003) return \"Win2003\";\n        let isWinVista = sUserAgent.indexOf(\"Windows NT 6.0\") > -1 || sUserAgent.indexOf(\"Windows Vista\") > -1;\n        if (isWinVista) return \"WinVista\";\n        let isWin7 = sUserAgent.indexOf(\"Windows NT 6.1\") > -1 || sUserAgent.indexOf(\"Windows 7\") > -1;\n        if (isWin7) return \"Win7\";\n        let isWin10 = sUserAgent.indexOf(\"Windows NT 10\") > -1 || sUserAgent.indexOf(\"Windows 10\") > -1;\n        if (isWin10) return \"Win10\";\n    }\n    return \"other\";\n}\n\nexport const getOtherLogininfo = () => {\n    // tslint:disable-next-line: deprecation\n    const performance = window.performance.timing || {};\n    const cd = window.screen.colorDepth;\n    const referrer = window.document.referrer;\n    const lang = navigator.language;\n    return {\n        performance,\n        timsDns: performance.domainLookupEnd - performance.domainLookupStart, // DNS解析时间： \n        timsTcp: performance.connectEnd - performance.connectStart,// TCP建立连接时间： \n        timsWhiteScreen: performance.responseStart - performance.navigationStart, // 白屏时间：\n        timsDomLoad: performance.domContentLoadedEventEnd - performance.navigationStart,// dom渲染完成时间： \n        timsLoad: performance.loadEventEnd - performance.navigationStart,// 页面onload时间：\n        lang,\n        referrer,\n        cd,\n    };\n};\n\nexport const detectZoom = () => {\n    var ratio = 0,\n        screen = window.screen,\n        ua = navigator.userAgent.toLowerCase();\n\n    if (~ua.indexOf('firefox')) {\n        if (window.devicePixelRatio !== undefined) {\n            ratio = window.devicePixelRatio;\n        }\n    } else if (~ua.indexOf('msie')) {\n        if (screen.deviceXDPI && screen.logicalXDPI) {\n            ratio = screen.deviceXDPI / screen.logicalXDPI;\n        }\n    } else if (window.outerWidth !== undefined && window.innerWidth !== undefined) {\n        ratio = window.outerWidth / window.innerWidth;\n    }\n\n    if (ratio) {\n        ratio = Math.round(ratio * 100);\n    }\n\n    // 360安全浏览器下浏览器最大化时诡异的outerWidth和innerWidth不相等\n    if (ratio === 99 || ratio === 101) {\n        ratio = 100;\n    }\n\n    return ratio;\n}\nexport const getLogininfo = () => {\n    const windowScreen = {\n        height: window.screen.height,\n        width: window.screen.width,\n    };\n    const windowWidthHeights = {\n        innerWidth: window.innerWidth || window.document.body && window.document.body.clientWidth || \"UNKONW\", // 浏览器缩放后的像素\n        innerHeight: window.innerHeight || window.document.body && window.document.body.clientHeight || \"UNKONW\" // 浏览器缩放后的像素\n    };\n    // const userinfo = window.sessionStorage.getItem(\"_u\");\n    return {\n        zoom: detectZoom(),\n        os:getOS(),\n        browserinfo:getBrowserinfo(),\n        windowScreen,\n        windowWidthHeights,\n        // userinfo,\n    };\n};\n\n\n\n\nexport function getSystemInfo (){\n\treturn {\n\t\t...getLogininfo(),\n\t\t...getOtherLogininfo()\n\t};\n}","const clientList = {};\nfunction listen(key:  string, fn: Function){\n  if (!clientList[key]) {\n    clientList[key] = [];\n  }\n  clientList[key].push(fn); // 订阅的消息添加进缓存列表\n}\nfunction trigger(type: string, ...money: any) {\n  let fns = clientList[type];\n  if (!fns || fns.length === 0) {\n    // 如果没有绑定对应的消息\n    return false;\n  }\n  fns.forEach((fn: Function) => {\n    fn.apply(this, money);\n  });\n}\n\n\nfunction remove(key:  string, fn?: Function){\n  if(!clientList[key])return false;\n  if(!fn){\n    clientList[key].length = 0;\n    return true;\n  }else{\n    const index = clientList[key].findIndex(item=>item === fn)\n    if(index>-1){\n      clientList[key].splice(index,1);\n      return true;\n    }\n    return false;\n  }\n}\n\n\nexport {\n  listen,\n  trigger,\n  remove\n}","\nimport { servicePath } from \"../config/config\";\nimport { getUserInfo,UserInfo } from \"../userinfo/index\";\nimport { listen } from \"../utils/obersve\";\nimport { version } from '../../package.json';\n\n\nexport interface PostDataInfo {\n    _uu: string;\n    _ct: string;\n    _p: string;\n    _uid?: string;\n    _fm: string;\n    _v:string;\n}\n\nlet serviceUrl = servicePath;\nlisten(\"changeUrl\",(path)=>{\n    serviceUrl = path ;\n})\n\n\nconst gifPostApi = function(option: object,type = \"er\"){\n    const gif = document.createElement(\"img\");\n    const postOption = createUrl({...option,_te:type});\n    const path = serviceUrl+ \"pr/e.gif\"+postOption;\n    gif.src = path;\n};\n\nfunction getPostInfo(): PostDataInfo{\n    let userinfo:UserInfo = getUserInfo();\n    const { userid , uid, projectInfo,clientType} = userinfo;\n    const { href }  = window.location;\n    let option: PostDataInfo = {\n        _uu:uid,\n        _ct:clientType,\n        _p:projectInfo,\n        _fm:href,\n        _v:version\n    }\n    if(userid){\n        option._uid = userid;\n    }\n    return option;\n}\n\nfunction createUrl(info){\n    let arr = [];\n    const deInfo = getPostInfo();\n    const op = {...info,...deInfo}\n    for( let i in op ){\n        let value = op[i];\n        if(typeof value === \"object\"){\n            value = encodeURIComponent(JSON.stringify(value));\n        }\n        arr.push(`${i}=${encodeURIComponent(value)}`)\n    }\n    arr.push(\"_t=\"+  +new Date())\n    return \"?\"+arr.join(\"&\");\n}\n\nexport const postCloseData = function(fb){\n    let url = serviceUrl+\"cl\";\n    navigator.sendBeacon(url, fb);\n}\n\nexport const xhm = gifPostApi;\nexport const postError = function(option: object){\n    gifPostApi(option,\"er\");   \n}\n\n\n","\nimport { servicePath } from \"./config\";\nimport { setProject,setSystemUser,getUserInfo, UserInfo ,setClientType} from \"../userinfo/index\";\nimport { getSystemInfo } from \"../utils/os-browser\";\nimport { xhm } from '../service/xhm';\nimport { trigger }  from \"../utils/obersve\";\nconst  defaultConfig: any = {\n    url: servicePath,\n    delay : 1000,\n    mergeReport : true,\n    random: 1,\n    repeat:20\n}\nexport interface ConfigOption{\n    url?:string;   // 上报的地址\n    delay?:number; // 上报的时间间隔\n    mergeReport ?: boolean ; // 是否合并上报\n    random?: number;  // 抽样上报   （基于 Math.random）\n    repeat?: number;  // 重复多少次 不上报;\n    projectId?: string; // 项目id \n    clientType?: \"1\"|\"2\"|\"3\",\n    userId? :string ; // 用户id // 支持后续配置\n    onXMLResponsePostError?: (xhrInstanceStatusText : string)=>boolean ; // 如果存在该函数 并且还会true  会上报数据 主要用于项目自定义是否成功字段。\n}\n\nexport  function setConfig(option: any): void{\n    Object.assign(defaultConfig,option);\n    const { projectId, userId, clientType,url} = defaultConfig;\n    if(projectId){\n        setProject(projectId);\n    }\n    if(userId){\n        setSystemUser(userId);\n    }\n    if(clientType){\n        setClientType(clientType);\n    }\n    if(url){\n        trigger(\"changeUrl\",url);\n    }\n    if(clientType){\n        defaultConfig.clientType = clientType;\n    }\n    xhm(getSystem(),\"lo\")\n} \n\nexport function getSystem(): SystemInfo{\n\n    const postInfo: SystemInfo = {\n        inf:{\n            os:getSystemInfo()\n        }\n    }\n    return postInfo;\n}\nexport function getConfig(): ConfigOption{\n    return defaultConfig ;\n}\nexport interface SystemInfo{\n    _uu?: string;\n    _ct?: string;\n    inf?: any;\n    _uid?: string;\n}\n","import { servicePath } from \"../config/config\";\nimport { getUserInfo,UserInfo } from \"../userinfo/index\";\nimport { postCloseData } from \"../service/xhm\";\n\nfunction getCloseInfo(): Blob {\n\tconst systeminfo: UserInfo = getUserInfo();\n\tconst { uid } = systeminfo;\n\tconst blob = new Blob([`_uu=${uid}&_t=${+new Date()}`], {type : 'application/x-www-form-urlencoded'});\n\treturn blob;\n}\n\nlet isPost = false;\nfunction postData(){\n\tif(!isPost){\n\t\tlet fb = getCloseInfo();\n\t\tpostCloseData(fb);\n\t\tisPost = true;\n\t}\n}\n\nexport function bindBeforeunload() {\n\twindow.addEventListener('beforeunload', (event) => {\n\t\tpostData();\n\t\t// Chrome requires returnValue to be set.\n\t});\n\twindow.addEventListener(\"unload\",(event)=>{\n\t\tpostData();\n\t})\n\n}\n\n\n\n","const cacheObj: { [key: string]: CacheObj } = {};\n\nfunction getCache(key) {\n  return cacheObj[key];\n}\n\nfunction setCache(key: string, value: any) {\n  if (!cacheObj[key]) {\n    cacheObj[key] = {\n      data: \"\",\n      length: 0,\n      times: [],\n    };\n  }\n  value && (cacheObj[key].data = value);\n  cacheObj[key].length++;\n  cacheObj[key].times.push(+new Date());\n}\n\nexport function setCacheToMax(\n  key: string,\n  value: any,\n  repeat: number = -1\n): { data: CacheObj; length: number } | false {\n  // 如果存在repeat  并且 值大于0 而且缓存的数据大于repeat；\n  if (repeat > 0 && cacheObj[key] && cacheObj[key].length > repeat) {\n    return false;\n  } else {\n    setCache(key, value);\n    return { ...cacheObj[key], length: cacheObj[key].length };\n  }\n}\n\nexport interface CacheObj {\n  data: any;\n  length: number;\n  times: number[];\n}\n","import { postError, xhm } from \"./xhm\";\nimport { setCacheToMax } from \"./cacheInfo\";\nimport { getConfig, ConfigOption } from \"../config/global-config\";\nimport { listen, trigger, remove } from \"../utils/obersve\";\nimport { getStackLineCol }  from \"../utils/error-stack\";\n\n// 定时器 定时发送数据\nlet timer = null;\n\n// 定义一个数组存放错误数据;\nconst errorList = [];\nfunction needMax(): number {\n  const config: ConfigOption = getConfig();\n  const { repeat } = config;\n  return typeof repeat === \"number\" && repeat > 0 ? repeat : -1;\n}\n\nexport function pushErrorInfo(e?: Error, str: string = \"\", option:{line?:number,col?:number,other?: string} = {}) {\n  const errStr = e + str;\n  const { name, message, stack } = e;\n  const errorType =(<any>e)._errorName || e.name || \"unkonw\";\n  let { line ,col ,other } = option;\n  if(!line || !col){\n    const linecol =  getStackLineCol(stack);\n    if(linecol){\n      line = (linecol.line as any) * 1;\n      col = (linecol.col as any) * 1;\n    }\n  }\n  let value = {\n    name,\n    message,\n    stack,\n    errStr,\n    errorType,\n    time: +new Date(),\n    line,\n    col,\n    other\n  };\n  const pushInfo = setCacheToMax(errStr, value, needMax());\n  if (pushInfo) {\n    if(pushInfo.length>1){\n      let index = errorList.findIndex(item=>item.data.errStr===errStr);\n      if(index >-1){\n        errorList[index] = pushInfo;\n      }else{\n        pushInfo && errorList.push(pushInfo);\n      }\n    }else{\n      pushInfo && errorList.push(pushInfo);\n    }\n    trigger(\"onErrorPush\");\n  }\n}\n\nfunction doPost() {\n  if (!errorList.length) return;\n  const arr = errorList.slice(0);\n  errorList.length = 0;\n  postError({\n    list: arr,\n  });\n}\n\nfunction loopPostData() {\n  const config: ConfigOption = getConfig();\n  const { delay } = config;\n  listen(\"onErrorPush\", () => {\n    if (delay && delay > 0) {\n      if (!timer) {\n        timer = setInterval(() => {\n          doPost();\n        }, delay);\n      }\n    } else {\n      if (timer) {\n        clearInterval(timer);\n        timer = null;\n        doPost();\n      }\n    }\n  });\n}\n\nexport function initErrorPost() {\n  loopPostData();\n}\n\n\nexport interface ErrorInfo{\n  data: ErrorData;\n  length: number;\n  times: number[];\n}\n\nexport interface ErrorData {\n  name: string;\n  message: string;\n  stack: string;\n  errStr: string;\n  errorType: string;\n  time: number;\n}","export const getStackLineCol = function(stack){\n  if(!stack || typeof stack !==\"string\"){\n    return null\n  }\n  try{\n    stack = stack.replace( /\\(|\\)/g , \"\");\n    const arr = stack.split('\\n');\n    const errormsg = arr[1];\n    if(!errormsg)return null;\n    const linecol = errormsg.split(\":\");\n    if(linecol.length<2)return null;\n    const line = linecol[linecol.length - 2];\n    const col = linecol[linecol.length - 1];\n    return {\n      line:line,\n      col:col\n    }\n  }catch(e){\n    throw e;\n  }\n}","\nclass CustomError extends Error {\n  constructor(message: string,type?: string){\n    super();\n    this.message = message;\n    this.name = type;\n    this.stack = (new Error()).stack;\n  }\n}\n\nclass NetworkRequestError extends CustomError {\n  _errorName = \"NetworkRequestError\";\n  constructor(message: string,type: string = \"NetworkRequestError\"){\n    super(message,type);\n  }\n}\nclass UnkownError extends CustomError {\n  _errorName = \"UnkownError\"\n\n  constructor(message: string,type: string = \"UnkownError\"){\n    super(message,type);\n\n  }\n}\nclass UnhandledrejectionNotObjectError extends CustomError {\n  _errorName = \"UnhandledrejectionNotObjectError\"\n\n  constructor(message: string,type: string = \"UnhandledrejectionNotObjectError\"){\n    super(message,type);\n  }\n}\n\nclass XHMHttpResponseError extends CustomError {\n  _errorName = \"XHMHttpResponseError\"\n\n  constructor(message: string,type: string = \"XHMHttpResponseError\"){\n    super(message,type);\n  }\n}\nclass XHMHttpError extends CustomError {\n  _errorName = \"XHMHttpError\"\n  constructor(message: string,type: string = \"XHMHttpError\"){\n    super(message,type);\n  }\n}\n\n\n\nexport {\n  NetworkRequestError,\n  UnkownError,\n  UnhandledrejectionNotObjectError,\n  XHMHttpResponseError,\n  XHMHttpError\n}","\nimport { pushErrorInfo }  from \"../service/handleErrorPost\";\nimport { NetworkRequestError ,UnhandledrejectionNotObjectError}  from \"../error-types\";\nimport { fill } from \"../utils/object\";\n\nfunction bindError(){\n  window.onerror=function(msg,url,lineNo,columnNo,e){\n    if(msg===\"Script error.\" || !url){\n      return\n    }\n    pushErrorInfo(e,\"\",{line:lineNo,col:columnNo});\n  }\n}\n\nfunction bindUnhandelrejectionEvt(){\n  window.addEventListener(\"unhandledrejection\",(e)=>{\n    if(typeof e.reason === \"object\"){\n      pushErrorInfo(e.reason,\"未处理的 unhandledrejection 事件 --- \");\n    }else {\n      let message = typeof e.reason === \"string\"? e.reason : JSON.stringify(e.reason);\n      const error = new UnhandledrejectionNotObjectError(message)\n      pushErrorInfo(error)\n    }\n  })\n}\nfunction bindErrorEvt(){\n  window.addEventListener('error', event => {  \n    let error = null;\n    if(event.target instanceof HTMLScriptElement){\n      error = new NetworkRequestError(event.target.src,\"LoadScriptError\")\n    }\n    if(event.target instanceof HTMLLinkElement){\n      error = new NetworkRequestError(event.target.href,\"LoadLinkError\")\n    }\n    if(event.target instanceof HTMLImageElement){\n      error = new NetworkRequestError(event.target.src,\"LoadLinktError\")\n    }\n    error && pushErrorInfo(error); \n  },true); \n  \n}\n\nfunction bindTryCatchEvt(){\n  const proto = EventTarget.prototype;\n  fill(proto, 'addEventListener', function(\n    original: () => void,\n  ): (eventName: string, fn: EventListenerObject, options?: boolean | AddEventListenerOptions) => void {\n    return function(\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      this: any,\n      eventName: string,\n      fn: any,\n      options?: boolean | AddEventListenerOptions,\n    ): (eventName: string, fn: any, capture?: boolean, secure?: boolean) => void {\n      const addStack = new Error(`Event (${eventName})`).stack;\n      fn.__error_wrapped__ = function (...args) {\n        try {\n          return fn.apply(this, args);\n        }\n        catch (err) {\n          err.stack += '\\n' + addStack;\n          throw err;\n        }\n      }\n      return original.call(\n        this,\n        eventName,\n        fn.__error_wrapped__|| fn,\n        options,\n      );\n    };\n  });\n\n  fill(proto, 'removeEventListener', function(\n    original: () => void,\n  ): (this: any, eventName: string, fn: EventListenerObject, options?: boolean | EventListenerOptions) => () => void {\n    return function(\n      this: any,\n      eventName: string,\n      fn: EventListenerObject,\n      options?: boolean | EventListenerOptions,\n    ): () => void {\n      /**\n       * There are 2 possible scenarios here:\n       *\n       * 1. Someone passes a callback, which was attached prior to Sentry initialization, or by using unmodified\n       * method, eg. `document.addEventListener.call(el, name, handler). In this case, we treat this function\n       * as a pass-through, and call original `removeEventListener` with it.\n       *\n       * 2. Someone passes a callback, which was attached after Sentry was initialized, which means that it was using\n       * our wrapped version of `addEventListener`, which internally calls `wrap` helper.\n       * This helper \"wraps\" whole callback inside a try/catch statement, and attached appropriate metadata to it,\n       * in order for us to make a distinction between wrapped/non-wrapped functions possible.\n       * If a function was wrapped, it has additional property of `__sentry_wrapped__`, holding the handler.\n       *\n       * When someone adds a handler prior to initialization, and then do it again, but after,\n       * then we have to detach both of them. Otherwise, if we'd detach only wrapped one, it'd be impossible\n       * to get rid of the initial handler and it'd stick there forever.\n       */\n      try {\n        original.call(this, eventName, ((fn as any)).__error_wrapped__, options);\n      } catch (e) {\n        // ignore, accessing __sentry_wrapped__ will throw in some Selenium environments\n      }\n      return original.call(this, eventName, fn, options);\n    };\n  });\n\n\n  // const originAddEventListener = EventTarget.prototype.addEventListener;\n  // EventTarget.prototype.addEventListener = (type,listener,options)=>{\n  //   const wrappedListener = (...args)=>{\n  //     try{\n  //       return (listener as any).apply(this,args);\n  //     }catch(e){\n  //       throw e;\n  //     }\n  //   }\n  //   return originAddEventListener.call(this,type,wrappedListener,options);\n  // }\n}\n\nfunction bindVueEvt(){\n  if(!window.Vue || !window.Vue.config){\n    return ;\n  }\n  let _oldOnError = window.Vue.config.errorHandler;\n  window.Vue.config.errorHandler = function (errMsg: Error,vm: any,info: any){\n    pushErrorInfo(errMsg); \n    if(typeof _oldOnError === \"function\"){\n      _oldOnError.call(this,errMsg,vm,info)\n    }\n  }\n}\n\nexport function initBindEvent(){\n  bindError();\n  bindUnhandelrejectionEvt();\n  bindErrorEvt();\n  // bindTryCatchEvt();\n  bindVueEvt();\n}","import { bindBeforeunload } from \"./bind-close\";\nimport { initBindEvent } from \"./bind-error\";\nimport  bindXMLEvt  from \"./bind-xhm\"\n\nexport function initEvent(){\n    bindBeforeunload();\n    initBindEvent();\n    bindXMLEvt();\n}","import { pushErrorInfo } from \"../service/handleErrorPost\";\nimport { XHMHttpResponseError, XHMHttpError } from \"../error-types/index\";\nimport { getConfig, ConfigOption } from \"../config/global-config\";\n\nexport default function bindXMLEvt() {\n  if (!window.XMLHttpRequest) return;\n  const onXMLResponsePostError = getConfig().onXMLResponsePostError;\n  const nativeAjaxSend = XMLHttpRequest.prototype.send; // 首先将原生的方法保存。\n  const nativeAjaxOpen = XMLHttpRequest.prototype.open;\n\n  XMLHttpRequest.prototype.open = function (mothod, url, ...args) {\n    // 劫持open方法，是为了拿到请求的url\n\n    const xhrInstance = this;\n    xhrInstance._url = url;\n    xhrInstance._mothod = mothod;\n    return nativeAjaxOpen.apply(this, [mothod, url].concat(args));\n  };\n\n  XMLHttpRequest.prototype.send = function (...args) {\n    // 对于ajax请求的监控，主要是在send方法里处理。\n\n    const oldCb = this.onreadystatechange;\n    const oldErrorCb = this.onerror;\n    const xhrInstance = this;\n    xhrInstance._data = args[0];\n    xhrInstance.addEventListener(\"error\", function (e) {\n      // 这里捕获到的error是一个ProgressEvent。e.target 的值为 XMLHttpRequest的实例。当网络错误(ajax并没有发出去)或者发生跨域的时候，会触发XMLHttpRequest的error, 此时，e.target.status 的值为:0，e.target.statusText 的值为:''\n      const errorObj = {\n        error_status: {\n          status: e.target.status,\n        },\n        xml_mothod: xhrInstance._mothod,\n        xml_url: xhrInstance._url,\n        xml_query: xhrInstance._data,\n      };\n      if (!xhrInstance._responseError) {\n        xhrInstance._responseError = true;\n        /*接下来可以对errorObj进行统一处理*/\n        pushErrorInfo(new XHMHttpError(JSON.stringify(errorObj)), \"\", {\n          line: 0,\n          col: 0,\n          other: JSON.stringify({responseData:e.target.responseText.slice(0, 2000)}),\n        });\n      }\n    });\n\n    xhrInstance.addEventListener(\"abort\", function (e) {\n      // 主动取消ajax的情况需要标注，否则可能会产生误报\n      if (e.type === \"abort\") {\n        xhrInstance._isAbort = true;\n      }\n    });\n\n    this.onreadystatechange = function (...innerArgs) {\n      if (xhrInstance.readyState === 4) {\n        if (!xhrInstance._isAbort && xhrInstance.status !== 200) {\n          // 请求不成功时，拿到错误信息\n          const errorObj = {\n            error_msg: JSON.stringify({\n              status: xhrInstance.status,\n            }),\n            xml_url: xhrInstance._url,\n            xml_mothod: xhrInstance._mothod,\n            xml_query: xhrInstance._data,\n          };\n          if (!xhrInstance._responseError) {\n            xhrInstance._responseError = true;\n            /*接下来可以对errorObj进行统一处理*/\n            pushErrorInfo(\n              new XHMHttpResponseError(JSON.stringify(errorObj)),\n              \"\",\n              {\n                line: 0,\n                col: 0,\n                other: JSON.stringify({\n                  responseData: xhrInstance.responseText.slice(0, 2000),\n                }),\n              }\n            );\n          }\n        } else if (\n          xhrInstance.status === 200 &&\n          onXMLResponsePostError &&\n          onXMLResponsePostError(xhrInstance.responseText)\n        ) {\n          const errorObj = {\n            error_msg: JSON.stringify({\n              code: xhrInstance.status,\n            }),\n            xml_mothod: xhrInstance._mothod,\n            xml_url: xhrInstance._url,\n            xml_query: xhrInstance._data,\n          };\n          if (!xhrInstance._responseError) {\n            xhrInstance._responseError = true;\n            /*接下来可以对errorObj进行统一处理*/\n            pushErrorInfo(\n              new XHMHttpResponseError(JSON.stringify(errorObj)),\n              \"\",\n              {\n                line: 0,\n                col: 0,\n                other: JSON.stringify({\n                  responseData: xhrInstance.responseText.slice(0, 2000),\n                }),\n              }\n            );\n          }\n        }\n      }\n      oldCb && oldCb.apply(this, innerArgs);\n    };\n    return nativeAjaxSend.apply(this, args);\n  };\n}\n","const pluginObj = {\n  \n};\n\n\nexport function bindPlugin(pluginFn: any, library: any) {\n  const pl = pluginFn(library);\n  const {name , plugin}  = pl;\n  if(name && plugin){\n    plugin[name] = plugin;\n  }\n  return plugin;\n}\n\nexport function getPlugin(name: string):any{\n  return pluginObj[name]|| null;\n}\n\nexport { pluginReact } from \"./plugin-react\";","\n\nimport {setConfig , getSystem ,ConfigOption} from \"./config/global-config\";\nimport {xhm} from \"./service/xhm\";\nimport { setUser , getUserInfo ,initUserInfo} from \"./userinfo/index\";\nimport { initEvent } from \"./bindEvent/index\";\nimport {initPostError}  from \"./service/index\";\n\n\nexport { bindPlugin, getPlugin , pluginReact}  from \"./createPlugin\";\n/**\n * 配置系统参数\n * 配置的同时绑定自定义事件\n * \n */\nconst config = function(option: ConfigOption){\n    setConfig(option);\n    initEvent();\n    initPostError();\n}\nconst  setUserId = function(id: string){\n    let sys: any = getSystem();\n    const userInfo = getUserInfo();\n    if(!userInfo.userid){\n        setUser(id);\n    }else{\n        const _ouu = userInfo.uid;\n        initUserInfo();\n        sys = {\n            ...sys,\n            _ouu\n        }\n    }\n    xhm(sys,\"ch\");\n}\n\nexport {config,setUserId};\n\n\n","// import  { Component }  from \"react\";\n// import * as React from \"react\";\nimport { pushErrorInfo  } from \"../service/handleErrorPost\";\n// export class ErrorBoundary extends Component{\n//   constructor(props: any){\n//     super(props);\n//   }\n//   componentDidCatch(error: Error,info: any){\n//     pushErrorInfo(error);\n//     this.setState({error,info});\n//   }\n//   render(){\n//     const {error} = this.state as any;\n//     if(error){\n//       const {FallbackComponent} = this.props as any;\n//       if(FallbackComponent) return React.createElement(FallbackComponent,this.state);\n//       return null\n//     }\n//     return this.props.children;\n//   }\n// }\n\nexport function pluginReact(React: any){\n  class ErrorBoundary extends React.Component{\n      constructor(props: any){\n        super(props);\n        this.state = { hasError: false };\n      }\n      componentDidCatch(error: Error,info: any){\n        this.setState({ hasError: true });\n      }\n      render(){\n        if(this.state.hasError){\n          const {FallbackComponent} = this.props as any;\n          if(FallbackComponent) return React.createElement(FallbackComponent,this.state);\n          return null;\n        }\n        return this.props.children;\n      }\n    }\n    return {\n      name:\"react\",\n      plugin:ErrorBoundary\n    }\n}"],"names":["servicePath","userInfo","clientType","initUserInfo","uid","s","hexDigits","i","substr","Math","floor","random","join","Date","uuid","getUserInfo","setUser","id","userid","getBrowserinfo","agent","version","name","isIE","isGecko","isWebkit","isStrict","document","window","navigator","userAgent","toLowerCase","IEMode","documentMode","chrome","System","test","indexOf","compatMode","supportSubTitle","createElement","supportScope","ieVersion","match","e","console","log","operaVersion","opera","versionFilter","arg","length","start","end","type","openDatabase","shell","external","clientLanguage","clientInformation","languages","storeKeyLen","Object","keys","webstore","client","_getBrowserinfo","getOS","sUserAgent","isWin","platform","isMac","String","getOtherLogininfo","performance","timing","cd","screen","colorDepth","referrer","lang","language","timsDns","domainLookupEnd","domainLookupStart","timsTcp","connectEnd","connectStart","timsWhiteScreen","responseStart","navigationStart","timsDomLoad","domContentLoadedEventEnd","timsLoad","loadEventEnd","getLogininfo","windowScreen","height","width","windowWidthHeights","innerWidth","body","clientWidth","innerHeight","clientHeight","zoom","ratio","ua","undefined","devicePixelRatio","deviceXDPI","logicalXDPI","outerWidth","round","os","browserinfo","clientList","listen","key","fn","push","trigger","money","fns","forEach","apply","this","serviceUrl","path","gifPostApi","option","gif","postOption","info","arr","deInfo","userinfo","projectInfo","href","location","t","o","u","l","_uid","getPostInfo","op","value","encodeURIComponent","JSON","stringify","createUrl","p","src","xhm","defaultConfig","url","delay","mergeReport","repeat","setConfig","assign","projectId","userId","setSystemUser","setClientType","getSystem","inf","getConfig","isPost","postData","fb","sendBeacon","postCloseData","systeminfo","Blob","getCloseInfo","cacheObj","setCacheToMax","data","times","setCache","timer","errorList","pushErrorInfo","str","errStr","message","stack","errorType","_errorName","line","col","other","linecol","errormsg","replace","split","getStackLineCol","time","pushInfo","config","needMax","index","findIndex","item","doPost","slice","list","initErrorPost","setInterval","clearInterval","loopPostData","CustomError","Error","[object Object]","super","NetworkRequestError","UnhandledrejectionNotObjectError","XHMHttpResponseError","XHMHttpError","initBindEvent","onerror","msg","lineNo","columnNo","addEventListener","reason","event","error","target","HTMLScriptElement","HTMLLinkElement","HTMLImageElement","Vue","_oldOnError","errorHandler","errMsg","vm","call","bindVueEvt","initEvent","XMLHttpRequest","onXMLResponsePostError","nativeAjaxSend","prototype","send","nativeAjaxOpen","open","mothod","args","_url","_mothod","concat","oldCb","onreadystatechange","xhrInstance","_data","errorObj","error_status","status","xml_mothod","xml_url","xml_query","_responseError","responseData","responseText","_isAbort","innerArgs","readyState","error_msg","code","bindXMLEvt","pluginObj","pluginFn","library","pl","plugin","initPostError","React","ErrorBoundary","Component","props","state","hasError","setState","FallbackComponent","children","sys","_ouu","N"],"mappings":"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"}