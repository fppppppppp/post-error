!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).postError={})}(this,(function(e){const t="http://127.0.0.1:7002/";let n={clientType:"1"};function r(){const e=function(e){if(!e)throw new Error("please input LocalStorage key");return localStorage.getItem(e)||null}("__posterror__uuid");if(e)n.uuid=e;else{const e=function(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")+"-"+ +new Date}();n.uuid=e,t="__posterror__uuid",r=e,localStorage.setItem(t,r)}var t,r;const o=function(e,t){var n,r,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=[];if(t=t||o.length,e)for(n=0;n<e;n++)i[n]=o[0|Math.random()*t];else for(i[8]=i[13]=i[18]=i[23]="-",i[14]="4",n=0;n<36;n++)i[n]||(r=0|16*Math.random(),i[n]=o[19==n?3&r|8:r]);return i.join("")+"-"+ +new Date}();n.uid=o}function o(){return n.uid||r(),n}function i(e){n.userid=e}const s=()=>{const{agent:e,version:t,name:n,isIE:r,isGecko:o,isWebkit:i,isStrict:s}=(()=>{var e=window.document,t=window.navigator.userAgent.toLowerCase(),n=e.documentMode,r=window.chrome||!1,o={agent:t,isIE:/msie/.test(t),isGecko:t.indexOf("gecko")>0&&t.indexOf("like gecko")<0,isWebkit:t.indexOf("webkit")>0,isStrict:"CSS1Compat"===e.compatMode,supportSubTitle:function(){return"track"in e.createElement("track")},supportScope:function(){return"scoped"in e.createElement("style")},ieVersion:function(){try{return t.match(/msie ([\d.]+)/)[1]||0}catch(e){return console.log("error"),n}},operaVersion:function(){try{if(window.opera)return t.match(/opera.([\d.]+)/)[1];if(t.indexOf("opr")>0)return t.match(/opr\/([\d.]+)/)[1]}catch(e){return console.log("error"),0}},versionFilter:function(...e){if(1===e.length&&"string"==typeof e[0]){var t=e[0],n=t.indexOf(".");if(n>0){var r=t.indexOf(".",n+1);if(-1!==r)return t.substr(0,r)}return t}return 1===e.length?e[0]:0}};try{o.type=o.isIE?"IE":window.opera||t.indexOf("opr")>0?"Opera":t.indexOf("chrome")>0?"Chrome":window.openDatabase?"Safari":t.indexOf("firefox")>0?"Firefox":"unknow",o.version="IE"===o.type?o.ieVersion():"Firefox"===o.type?t.match(/firefox\/([\d.]+)/)[1]:"Chrome"===o.type?t.match(/chrome\/([\d.]+)/)[1]:"Opera"===o.type?o.operaVersion():"Safari"===o.type?t.match(/version\/([\d.]+)/)[1]:"0",o.shell=function(){if(t.indexOf("maxthon")>0)return o.version=t.match(/maxthon\/([\d.]+)/)[1]||o.version,"傲游浏览器";if(t.indexOf("qqbrowser")>0)return o.version=t.match(/qqbrowser\/([\d.]+)/)[1]||o.version,"QQ浏览器";if(t.indexOf("se 2.x")>0)return"搜狗浏览器";if(r&&"Opera"!==o.type){var e=window.external,n=window.clientInformation.languages;if(e&&"LiebaoGetVersion"in e)return"猎豹浏览器";if(t.indexOf("bidubrowser")>0)return o.version=t.match(/bidubrowser\/([\d.]+)/)[1]||t.match(/chrome\/([\d.]+)/)[1],"百度浏览器";if(o.supportSubTitle()&&void 0===n){var i=Object.keys(r.webstore).length;return window,i>1?"360极速浏览器":"360安全浏览器"}return"Chrome"}return o.type},o.name=o.shell(),o.version=o.versionFilter(o.version)}catch(e){console.log(e)}return{client:o}})().client;return{agent:e,version:t,name:n,isIE:r,isGecko:o,isWebkit:i,isStrict:s}};function a(){let e=navigator.userAgent,t="Win32"==navigator.platform||"Windows"==navigator.platform,n="Mac68K"==navigator.platform||"MacPPC"==navigator.platform||"Macintosh"==navigator.platform||"MacIntel"==navigator.platform;if(n)return"Mac";if("X11"==navigator.platform&&!t&&!n)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(t){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Win2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"WinXP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Win2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"WinVista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Win7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Win10"}return"other"}const c=()=>{const e=window.performance.timing||{},t=window.screen.colorDepth,n=window.document.referrer,r=navigator.language;return{performance:e,timsDns:e.domainLookupEnd-e.domainLookupStart,timsTcp:e.connectEnd-e.connectStart,timsWhiteScreen:e.responseStart-e.navigationStart,timsDomLoad:e.domContentLoadedEventEnd-e.navigationStart,timsLoad:e.loadEventEnd-e.navigationStart,lang:r,referrer:n,cd:t}},u=()=>{const e={height:window.screen.height,width:window.screen.width},t={innerWidth:window.innerWidth||window.document.body&&window.document.body.clientWidth||"UNKONW",innerHeight:window.innerHeight||window.document.body&&window.document.body.clientHeight||"UNKONW"};return{zoom:(n=0,r=window.screen,o=navigator.userAgent.toLowerCase(),~o.indexOf("firefox")?void 0!==window.devicePixelRatio&&(n=window.devicePixelRatio):~o.indexOf("msie")?r.deviceXDPI&&r.logicalXDPI&&(n=r.deviceXDPI/r.logicalXDPI):void 0!==window.outerWidth&&void 0!==window.innerWidth&&(n=window.outerWidth/window.innerWidth),n&&(n=Math.round(100*n)),99!==n&&101!==n||(n=100),n),os:a(),browserinfo:s(),windowScreen:e,windowWidthHeights:t};var n,r,o};const d={};function l(e,t){d[e]||(d[e]=[]),d[e].push(t)}function f(e,...t){let n=d[e];if(!n||0===n.length)return!1;n.forEach(e=>{e.apply(this,t)})}const p={url:t,delay:1e3,mergeReport:!0,random:1,repeat:20,debug:!1,autoTrack:!1,notTrackClass:["mp-no-track"],autoTrackTag:["input","button","a"]};function m(e){Object.assign(p,e);const{projectId:t,userId:r,clientType:o,url:i}=p;var s;t&&(s=t,n.projectInfo=s),r&&function(e){n.userid=e}(r),o&&function(e){n.clientType=e}(o),i&&f("changeUrl",i),o&&(p.clientType=o)}function h(){return{inf:{os:{...u(),...c()}}}}function g(){return p}function w(e){(e=e||{}).type=(e.type||"GET").toUpperCase(),e.dataType=e.dataType||"json";var t=function(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.push(("v="+Math.random()).replace(".","")),t.join("&")}(e.data),n=new XMLHttpRequest;"GET"==e.type?(n.open("GET",e.url+"?"+t,!0),n.send(null)):"POST"==e.type&&(n.open("post",e.url,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(t));var r=null;e.timeout&&(r=setTimeout((function(){4!=n.readyState&&n.abort()}),e.timeout)),n.onreadystatechange=function(){if(4==n.readyState){e.timeout&&clearTimeout(r);var t=n.status;t>=200&&t<300||304==t?e.success&&e.success(n.responseText,n):e.error&&e.error(t,n)}}}let y=t;l("changeUrl",e=>{y=e});const x=function(e,t="er"){const n=g().debug,r=function(e){const t=v(e);let n=[];for(let e in t)n.push(`${e}=${encodeURIComponent(t[e])}`);return n.join("&")}(Object.assign(Object.assign({},e),{_te:t}));if(navigator&&navigator.sendBeacon){const e=new Blob([r],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(y+"pr/",e)}else r.length>5e3?w({url:y+"pr/",type:"POST",data:v(Object.assign(Object.assign({},e),{_te:t}))}):function(e){const t=document.createElement("img"),n=y+"pr/e.gif?"+e;t.src=n}(r);n&&console.log(`发送了一次请求，类型为${function(e){switch(e){case"lo":return"登录";case"er":return"异常";case"ex":return"退出";case"ch":return"修改用户数据";case"pe":return"上传页面性能";case"cl":return"页面点击事件";case"ro":return"路由切换"}}(t)}; 参数为`,v(Object.assign(Object.assign({},e),{_te:t})))};function v(e){const t=function(){let e=o();const{userid:t,uid:n,projectInfo:r,clientType:i,uuid:s}=e,{href:a}=window.location;let c={_u:s,_uu:n,_ct:i,_p:r,_fm:a,_v:"0.5.5",_tm:performance?performance.now():0,_tit:document.title};return t&&(c._uid=t),c}(),n=Object.assign(Object.assign({},e),t);for(let e in n){let t=n[e];"object"==typeof t&&(t=JSON.stringify(t)),n[e]=t}return n._t=+new Date,n}const _=x;let b=!1;function E(){b||(_({},"ex"),b=!0)}const O={};function T(e,t,n=-1){return!(n>0&&O[e]&&O[e].length>n)&&(function(e,t){O[e]||(O[e]={data:"",length:0,times:[]}),t&&(O[e].data=t),O[e].length++,O[e].times.push(+new Date)}(e,t),Object.assign(Object.assign({},O[e]),{length:O[e].length}))}let N=null;const L=[];function k(e,t="",n={}){const r=e+t,{name:o,message:i,stack:s}=e,a=e._errorName||e.name||"unkonw";let{line:c,col:u,other:d}=n;if(!c||!u){const e=function(e){if(!e||"string"!=typeof e)return null;try{const t=(e=e.replace(/\(|\)/g,"")).split("\n")[1];if(!t)return null;const n=t.split(":");if(n.length<2)return null;return{line:n[n.length-2],col:n[n.length-1]}}catch(e){throw e}}(s);e&&(c=1*e.line,u=1*e.col)}let l={name:o,stack:s,errStr:r,errorType:a,time:+new Date,line:c,col:u,other:d};const p=T(r,l,function(){const e=g(),{repeat:t}=e;return"number"==typeof t&&t>0?t:-1}());if(p){if(p.length>1){let e=L.findIndex(e=>e.data.errStr===r);e>-1?L[e]=p:p&&L.push(p)}else p&&L.push(p);f("onErrorPush")}}function S(){if(!L.length)return;const e=L.slice(0);L.length=0,x({list:e},"er")}function j(){!function(){const e=g(),{delay:t,mergeReport:n}=e;l("onErrorPush",()=>{n&&t&&t>0?N||(N=setInterval(()=>{S()},t)):(N&&(clearInterval(N),N=null),S())})}()}class W extends Error{constructor(e,t){super(),this.message=e,this.name=t}}class M extends W{constructor(e,t="NetworkRequestError"){super(e,t),this._errorName="NetworkRequestError"}}class C extends W{constructor(e,t="UnhandledrejectionNotObjectError"){super(e,t),this._errorName="UnhandledrejectionNotObjectError"}}class I extends W{constructor(e,t="XHMHttpResponseError"){super(e,t),this._errorName="XHMHttpResponseError"}}class H extends W{constructor(e,t="XHMHttpError"){super(e,t),this._errorName="XHMHttpError"}}function R(){window.onerror=function(e,t,n,r,o){"Script error."!==e&&t&&k(o,"",{line:n,col:r})},window.addEventListener("unhandledrejection",e=>{if("object"==typeof e.reason)k(e.reason,"未处理的 unhandledrejection 事件 --- ");else{let t="string"==typeof e.reason?e.reason:JSON.stringify(e.reason);k(new C(t))}}),window.addEventListener("error",e=>{let t=null;e.target instanceof HTMLScriptElement&&(t=new M(e.target.src,"LoadScriptError")),e.target instanceof HTMLLinkElement&&(t=new M(e.target.href,"LoadLinkError")),e.target instanceof HTMLImageElement&&(t=new M(e.target.src,"LoadLinktError")),t&&k(t)},!0),function(){if(!window.Vue||!window.Vue.config)return;let e=window.Vue.config.errorHandler;window.Vue.config.errorHandler=function(t,n,r){k(t),"function"==typeof e&&e.call(this,t,n,r)}}()}const X=function(){document.body.addEventListener("click",e=>{let t=e.target;t.nodeType===Node.TEXT_NODE&&(t=t.parentNode),function(e,t){const n=g();if(!e||"HTML"===e.tagName.toLowerCase()||e.nodeType!==Node.ELEMENT_NODE)return!1;if(e.getAttribute("data-track-id"))return!0;var r=e.tagName.toLowerCase();if(n.autoTrack&&!n.autoTrackTag.includes(r))return!1;switch(r){case"html":return!1;case"form":return"submit"===t.type;case"input":return-1===["button","submit"].indexOf(e.getAttribute("type"))?"change"===t.type:"click"===t.type;case"select":case"textarea":return"change"===t.type;default:return"click"===t.type}}(t,e)&&D(e)})},D=function(e,t=!0){let n;e.nodeType===Node.TEXT_NODE&&(e=e.parentNode);for(var r=[e],o=e;o.parentNode&&"body"!==o.tagName.toLowerCase();)r.push(o.parentNode),o=o.parentNode;var i,s=[];const a=g().notTrackClass;for(let e=0;e<r.length;e++){const t=r[e];"a"===t.tagName.toLowerCase()&&(i=t.getAttribute("href")||"");var c=t.className&&t.className.split(" ")||[];if(c.filter(e=>a.includes(e)).length)return!1;s.push(t.nodeName&&t.nodeName.toLocaleLowerCase()+(t.id?"#"+t.id:"")+c.map(e=>"."+e).join(" ."))}return n={elements:s,target_text:e.textContent.slice(0,255),a_href:i,info:e.getAttribute("data-track")||"",tag_name:e.tagName.toLowerCase(),element_path:s.reverse().join(" "),track_id:e.getAttribute("data-track-id")||""},_(n,"cl"),!0};function P(){window.addEventListener("beforeunload",e=>{E()}),window.addEventListener("unload",e=>{E()}),R(),function(){if(!window.XMLHttpRequest)return;const e=g().onXMLResponsePostError,t=XMLHttpRequest.prototype.send,n=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(e,t,...r){return this._url=t,this._mothod=e,n.apply(this,[e,t].concat(r))},XMLHttpRequest.prototype.send=function(...n){const r=this.onreadystatechange,o=(this.onerror,this);return o._data=n[0],o.addEventListener("error",(function(e){const t={error_status:{status:e.target.status},xml_mothod:o._mothod,xml_url:o._url,xml_query:o._data};o._responseError||(o._responseError=!0,k(new H(JSON.stringify(t)),"",{line:0,col:0,other:e.target.responseText.slice(0,200)}))})),o.addEventListener("abort",(function(e){"abort"===e.type&&(o._isAbort=!0)})),this.onreadystatechange=function(...t){if(4===o.readyState)if(o._isAbort||200===o.status){if(200===o.status&&e&&"text"===o.responseType.type&&e(o.responseText,o)){const e={error_msg:JSON.stringify({code:o.status}),xml_mothod:o._mothod,xml_url:o._url,xml_query:o._data};o._responseError||(o._responseError=!0,k(new I(JSON.stringify(e)),"",{line:0,col:0,other:JSON.stringify({responseData:o.responseText.slice(0,2e3)})}))}}else{const e={error_msg:JSON.stringify({status:o.status}),xml_url:o._url,xml_mothod:o._mothod,xml_query:o._data};o._responseError||(o._responseError=!0,k(new I(JSON.stringify(e)),"",{line:0,col:0,other:o.responseText.slice(0,200)}))}r&&r.apply(this,t)},t.apply(this,n)}}(),window.addEventListener("load",()=>{const e=window.performance;_({performance:e},"pe")}),X()}let q=0,U=!0;const V={};const A={postRouter:function(e,t){const n=performance.now();_({router_from:e,router_to:t,router_times:n-q,first:U},"ro"),q=n,U=!1},postClick:D};e.bindPlugin=function(e,t){const n=e(t),{name:r,plugin:o}=n;return r&&o&&(o[r]=o),o},e.config=function(e){m(e),_(h(),"lo"),P(),j()},e.getPlugin=function(e){return V[e]||null},e.handTrack=A,e.pluginReact=function(e){class t extends e.Component{constructor(e){super(e),this.state={hasError:!1}}componentDidCatch(e,t){this.setState({hasError:!0})}render(){if(this.state.hasError){const{FallbackComponent:t}=this.props;return t?e.createElement(t,this.state):null}return this.props.children}}return{name:"react",plugin:t}},e.setUserId=function(e,t){let n=h();const s=o();if(s.userid){const e=s.uid;r(),n=Object.assign(Object.assign({},n),{_ouu:e})}else i(e);t&&(n.info=t),delete n.inf,_(n,"ch")},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=bundle.min.js.map
